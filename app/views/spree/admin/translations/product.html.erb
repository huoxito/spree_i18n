<%= render :partial => 'spree/admin/shared/product_sub_menu' %>

<%= render :partial => 'spree/admin/shared/product_tabs', :locals => { :current => 'Translations' } %>

<%= render :partial => 'spree/shared/error_messages', :locals => { :target => @product } %>

<% content_for :page_actions do %>
  <li>
    <%= link_to_add_fields t(:add_product_translations), 'tbody#product_properties', :class => 'icon-plus button' %>
  </li>
<% end %>

<div class="row">
  <fieldset class="no-border-top">
    <fieldset class="no-border-bottom">
      <legend>Settings</legend>

      <div class="alpha six columns field">
        <label for="show-only">Show only: </label>
        <ul>
          <li><input type="radio" name="show-only" value="all" checked> <label>All Translations</label></li>
          <li><input type="radio" name="show-only" value="incomplete"> <label>Only Incomplete</label></li>
          <li><input type="radio" name="show-only"value="complete"> <label>Only Complete</label></li>
        </ul>
      </div>

      <div class="omega six columns">
        <label for="locale">Select locale: </label>
        <%= select_tag(:locale, options_for_select(admin_options_for_locale_select, Spree::Config.all_locales),  :class => 'fullwidth' , :multiple => 'true') %>
      </div>
    </fieldset>

    <fieldset class="alpha four columns no-border-bottom">
      <legend>Product fields</legend>
      <nav class="menu">
        <ul id="attr_list">
          <% @product.class.translates.each_with_index do |attr,i| %>
            <li class="<%= 'active' if i == 0 %>">
              <a data-attr="<%= attr %>" href="#"><%= attr %></a>
            </li>
          <% end %>
        </ul>
      </nav>
    </fieldset>

    <%= form_for [:admin, @product], :method => :put, :html => { :multipart => true } do |f| %>
      <fieldset class="omega eight columns no-border-bottom">
        <legend>Translations</legend>
        <table id="attr_fields" class="no-borders">
          <colgroup>
            <col style="width: 10%" />
            <col style="width: 90%" />
          </colgroup>
          <tbody>
            <% Spree::Config.all_locales.each do |locale| %>
              <%= f.globalize_fields_for locale.to_sym do |g| %>
                <% @product.class.translates.each_with_index do |attr,i| %>
                    <tr style="display:<%= i == 0 ? 'auto' : 'none' %>;" class="<%= attr %> <%= locale %> even">
                      <td style="padding:4px;" colspan="2">
                        <%= t(:this_file_language, :locale => locale) %> - 
                        <%= t(attr, :locale => locale ) %>
                      </td>
                    </tr>
                    <tr style="display:<%= i == 0 ? 'auto' : 'none' %>;" class="<%= attr %> <%= locale %> odd">
                      <td class="flag table-column">
                        <% if locale.include?('-') %>
                          <img src="http://www.localeapp.com/assets/flags/regions/<%= locale.split('-').last %>.png">
                        <% else %>
                          <img src="http://www.localeapp.com/assets/flags/languages/<%= locale %>.png">
                        <% end %>
                      </td>
                      <td class="translation table-column">
                        <% if @product.class.columns_hash[attr.to_s].type == :text %>
                          <%= g.text_area attr, :class => "fullwidth", :rows => 4 %>
                        <% else %>
                          <%= g.text_field attr, :class => "fullwidth" %>
                        <% end %>
                      </td>
                    </tr>
                <% end %>
              <% end %>
            <% end %>
          </tbody>
          <tfoot>
            <tr style="display:none;">
              <td colspan="2"></td>
            </tr>
          </tfoot>
        </table>

      </fieldset>
      <%= render :partial => 'spree/admin/shared/edit_resource_links' %>

    <% end %>
  </fieldset>
</div>
